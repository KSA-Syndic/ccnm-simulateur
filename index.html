<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="favicon.svg">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur de Classification et R√©mun√©ration - M√©tallurgie 2024</title>
    <!-- Popper.js & Tippy.js pour les tooltips -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/animations/shift-away.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="simulator-container">
        <!-- En-t√™te -->
        <header class="simulator-header">
            <h1>üè≠ Simulateur M√©tallurgie 2024</h1>
            <p class="subtitle">
                <span id="header-subtitle-text">Classification et R√©mun√©ration</span>
                <span id="header-info-icon" class="header-info tooltip-trigger__light" data-tippy-content="" title="Aide"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></span>
            </p>
        </header>

        <!-- Indicateur de progression -->
        <div class="wizard-progress" id="wizard-progress">
            <div class="progress-step active" data-step="1">
                <span class="progress-dot">1</span>
                <span class="progress-label">Classification</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="2">
                <span class="progress-dot">2</span>
                <span class="progress-label">Situation</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="3">
                <span class="progress-dot">3</span>
                <span class="progress-label">R√©sultat</span>
            </div>
            <div class="progress-line stepper-step-4-optional" id="progress-line-before-4"></div>
            <div class="progress-step stepper-step-4-optional" data-step="4" id="progress-step-4">
                <span class="progress-dot">4</span>
                <span class="progress-label">Arri√©r√©s</span>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- √âTAPE 1 : CLASSIFICATION -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="wizard-step active" id="step-1">
            
            <!-- 1A: Choix du mode -->
            <div class="step-content" id="step-1a">
                <h2>Connaissez-vous votre classification ?</h2>
                <p class="step-subtitle">Elle figure sur votre fiche de paie (ex: F11, D7, A1...)</p>
                
                <div class="choice-cards">
                    <button class="choice-card" id="btn-connais-classe">
                        <span class="choice-icon">‚úì</span>
                        <span class="choice-title">Oui, je la connais</span>
                        <span class="choice-desc">Je saisis directement ma classification</span>
                    </button>
                    
                    <button class="choice-card" id="btn-estimer-classe">
                        <span class="choice-icon">?</span>
                        <span class="choice-title">Non, je veux l'estimer</span>
                        <span class="choice-desc">Je r√©ponds aux 6 crit√®res classants</span>
                    </button>
                </div>
            </div>

            <!-- 1B: Saisie directe de la classe -->
            <div class="step-content hidden" id="step-1b">
                <h2>Votre classification</h2>
                <p class="step-subtitle">S√©lectionnez votre groupe et classe</p>
                
                <div class="classification-direct">
                    <div class="select-group-large">
                        <label for="select-groupe">Groupe</label>
                        <select id="select-groupe" class="book-select book-select-large">
                            <option value="A">A - Employ√©s/Ouvriers</option>
                            <option value="B">B - Employ√©s/Ouvriers</option>
                            <option value="C">C - Techniciens</option>
                            <option value="D">D - Techniciens</option>
                            <option value="E">E - Agents de ma√Ætrise</option>
                            <option value="F">F - Cadres</option>
                            <option value="G">G - Cadres</option>
                            <option value="H">H - Cadres sup√©rieurs</option>
                            <option value="I">I - Cadres dirigeants</option>
                        </select>
                    </div>
                    <div class="select-group-large">
                        <label for="select-classe">Classe</label>
                        <select id="select-classe" class="book-select book-select-large">
                            <!-- Options g√©n√©r√©es dynamiquement -->
                        </select>
                    </div>
                </div>

                <div class="classification-result-mini vertical">
                    <div class="classification-badge large">
                        <span class="groupe" id="groupe-display">A</span>
                        <span class="classe" id="classe-display">1</span>
                    </div>
                    <span class="statut-badge" id="statut-badge">Non-Cadre</span>
                </div>

                <div class="step-actions">
                    <button class="book-btn btn-secondary" id="btn-back-1b">
                        <span class="btn-icon btn-icon-left">‚Äπ</span> Retour
                    </button>
                    <button class="book-btn btn-primary" id="btn-next-1b">
                        Suivant <span class="btn-icon btn-icon-right">‚Ä∫</span>
                    </button>
                </div>
            </div>

            <!-- 1C: Estimation par crit√®res -->
            <div class="step-content hidden" id="step-1c">
                <h2>Estimation de votre classification</h2>
                <p class="step-subtitle">√âvaluez votre poste sur les 6 crit√®res (de 1 √† 10)</p>
                
                <div class="roulettes-container" id="roulettes-container">
                    <!-- Les roulettes seront g√©n√©r√©es dynamiquement -->
                </div>

                <div class="estimation-result vertical">
                    <div class="score-mini">
                        <span class="score-label">Score</span>
                        <span class="score-value" id="score-total">6</span>
                        <span class="score-max">/ 60</span>
                    </div>
                    <div class="classification-badge large" id="classification-estimated">
                        <span class="groupe" id="groupe-auto">A</span>
                        <span class="classe" id="classe-auto">1</span>
                    </div>
                    <span class="statut-badge" id="statut-badge-auto">Non-Cadre</span>
                </div>

                <div class="step-actions">
                    <button class="book-btn btn-secondary" id="btn-back-1c">
                        <span class="btn-icon btn-icon-left">‚Äπ</span> Retour
                    </button>
                    <button class="book-btn btn-primary" id="btn-next-1c">
                        Valider <span class="btn-icon btn-icon-right">‚Ä∫</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- √âTAPE 2 : SITUATION / MODALIT√âS -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="wizard-step hidden" id="step-2">
            <div class="step-content">
                <h2>Votre situation</h2>
                <p class="step-subtitle">Renseignez vos informations pour affiner le calcul</p>

                <!-- R√©cap classification -->
                <div class="recap-classification">
                    <div class="recap-badge-wrapper">
                        <div class="classification-badge small">
                            <span class="groupe" id="recap-groupe">A</span>
                            <span class="classe" id="recap-classe">1</span>
                        </div>
                        <span class="statut-badge small" id="recap-statut">Non-Cadre</span>
                    </div>
                    <button class="btn-link" id="btn-modifier-classe">Modifier</button>
                </div>

                <!-- Anciennet√© -->
                <div class="form-group">
                    <label for="anciennete">
                        Anciennet√© dans l'entreprise
                        <span class="tooltip-trigger" data-tippy-content="Prime d'anciennet√© : CCN d√®s 3 ans (non-cadres). Avec un accord d'entreprise, le seuil de cette prime et les conditions d'anciennet√© d'autres primes (ex. prime vacances) peuvent diff√©rer.">?</span>
                    </label>
                    <div class="input-with-unit">
                        <input type="number" id="anciennete" class="book-input" min="0" max="50" value="0">
                        <span class="input-unit">ans</span>
                    </div>
                </div>

                <!-- Options Non-Cadre -->
                <div class="modalites-non-cadre" id="modalites-non-cadre">
                    <div class="form-group">
                        <label for="point-territorial">
                            Valeur du Point Territorial
                            <span class="tooltip-trigger" data-tippy-content="Valeur d√©finie par accord territorial. Bas-Rhin 2025 : 5.90‚Ç¨&lt;br&gt;&lt;a href='https://code.travail.gouv.fr/contribution/3248-quand-le-salarie-a-t-il-droit-a-une-prime-danciennete-quel-est-son-montant' target='_blank'&gt;Voir sur code.travail.gouv.fr&lt;/a&gt;">?</span>
                        </label>
                        <div class="input-with-unit">
                            <input type="number" id="point-territorial" class="book-input" min="0" max="20" step="0.01" value="5.90">
                            <span class="input-unit">‚Ç¨</span>
                        </div>
                    </div>
                </div>

                <!-- Options Cadre -->
                <div class="modalites-cadre hidden" id="modalites-cadre">
                    <div class="form-group">
                        <label for="forfait">Type de forfait <span class="tooltip-trigger" id="forfait-tooltip" data-tippy-content="Base 35h : sans majoration. Forfait Heures : +15%. Forfait Jours : +30%." aria-label="Taux">?</span></label>
                        <select id="forfait" class="book-select">
                            <option value="35h">Base 35h</option>
                            <option value="heures">Forfait Heures</option>
                            <option value="jours">Forfait Jours</option>
                        </select>
                    </div>

                    <!-- Cadre D√©butant F11/F12 -->
                    <div class="cadre-debutant hidden" id="cadre-debutant">
                        <div class="form-group">
                            <label for="experience-pro">
                                Exp√©rience professionnelle totale
                                <span class="tooltip-trigger" data-tippy-content="Si < 6 ans, bar√®me d√©butants appliqu√©.">?</span>
                            </label>
                            <div class="input-with-unit">
                                <input type="number" id="experience-pro" class="book-input" min="0" max="50" value="0">
                                <span class="input-unit">ans</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conditions de travail (collapsible) -->
                <details class="conditions-details" id="conditions-travail">
                    <summary>Conditions de travail particuli√®res</summary>
                    
                    <div class="conditions-content">
                        <!-- Note forfait jours -->
                        <div class="book-hint info hidden" id="hint-forfait-jours">
                            <p><strong>üìã Forfait jours :</strong> En tant que cadre au forfait jours, les majorations pour travail de nuit ou du dimanche ne s'appliquent pas financi√®rement. Elles donnent lieu √† du <strong>repos compensateur</strong> (non simulable ici).</p>
                        </div>
                        
                        <!-- Travail de nuit -->
                        <div class="form-group" id="group-nuit">
                            <label for="type-nuit">Travail de nuit <span class="tooltip-trigger" id="type-nuit-tooltip" data-tippy-content="Poste de nuit : +15%.&lt;br&gt;Poste matin/AM : +15%." aria-label="Taux">?</span></label>
                            <select id="type-nuit" class="book-select">
                                <option value="aucun">Aucun</option>
                                <option value="poste-nuit" id="option-poste-nuit">Poste de nuit</option>
                                <option value="poste-matin" id="option-poste-matin">Poste matin/AM</option>
                            </select>
                            <div class="sub-field hidden" id="heures-nuit-field">
                                <label for="heures-nuit">Heures de nuit/mois</label>
                                <input type="number" id="heures-nuit" class="book-input" min="0" max="200" value="0">
                            </div>
                        </div>

                        <!-- Travail dimanche -->
                        <div class="form-group" id="group-dimanche">
                            <label class="checkbox-label">
                                <input type="checkbox" id="travail-dimanche" class="book-checkbox">
                                <span>Travail le dimanche</span>
                                <span class="tooltip-trigger" id="travail-dimanche-tooltip" data-tippy-content="+100%." aria-label="Taux">?</span>
                            </label>
                            <div class="sub-field hidden" id="heures-dimanche-field">
                                <label for="heures-dimanche">Heures dimanche/mois</label>
                                <input type="number" id="heures-dimanche" class="book-input" min="0" max="50" value="0">
                            </div>
                        </div>

                        <!-- Primes horaires accord (rempli dynamiquement) -->
                        <div id="accord-primes-horaires-container" class="accord-primes-horaires"></div>
                    </div>
                </details>

                <div class="step-actions">
                    <button class="book-btn btn-secondary" id="btn-back-2">
                        <span class="btn-icon btn-icon-left">‚Äπ</span> Retour
                    </button>
                    <button class="book-btn btn-primary" id="btn-next-2">
                        Calculer <span class="btn-icon btn-icon-right">‚Ä∫</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- √âTAPE 3 : R√âSULTAT -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="wizard-step hidden" id="step-3">
            <div class="step-content">
                <h2>Votre r√©mun√©ration</h2>
                <p class="step-subtitle">Total annuel brut (salaire minimum hi√©rarchique (SMH) + primes et majorations)</p>

                <!-- Options de calcul (visible seulement si un accord est charg√© depuis l'URL) -->
                <div class="result-options" id="result-accord-options-block">
                    <!-- Accord d'entreprise -->
                    <div class="option-group">
                        <label class="checkbox-label checkbox-highlight">
                            <input type="checkbox" id="accord-actif" class="book-checkbox">
                            <span>Appliquer l'accord d'entreprise</span>
                            <span class="tooltip-trigger" id="accord-actif-tooltip" data-tippy-content="Si votre entreprise applique un accord d'entreprise, cochez cette case pour inclure ses r√®gles dans le calcul (primes, anciennet√©, majorations).">?</span>
                        </label>
                        <!-- Options accord (primes, etc.) -->
                        <div class="sub-options hidden" id="accord-options">
                            <label class="checkbox-label">
                                <input type="checkbox" id="prime-vacances" class="book-checkbox" checked>
                                <span>Prime de vacances (525‚Ç¨/an)</span>
                            </label>
                        </div>
                        <!-- Message lorsque l'accord est d√©sactiv√© : modalit√©s qui ne sont plus prises en compte (hors primes page 3, √©videntes) -->
                        <div class="accord-desactive-message hidden" id="accord-desactive-message" role="status" aria-live="polite"></div>
                    </div>
                </div>

                <!-- Carte r√©sultat -->
                <div class="result-card">
                    <div class="result-main">
                        <span class="result-value" id="result-smh">21 500 ‚Ç¨</span>
                        <span class="result-label" id="result-label-annuel">par an</span>
                    </div>

                    <div class="result-monthly">
                        <span class="result-value-secondary" id="result-mensuel">1 792 ‚Ç¨</span>
                        <span class="result-label" id="result-label-mensuel">par mois</span>
                        <div class="months-toggle">
                            <button type="button" class="month-btn active" data-months="12">12 mois</button>
                            <button type="button" class="month-btn" data-months="13">13 mois</button>
                        </div>
                    </div>
                </div>

                <!-- D√©tails -->
                <details class="result-details-toggle" open>
                    <summary>D√©tail du calcul</summary>
                    <div class="result-details" id="result-details">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </details>

                <!-- Infos contextuelles -->
                <div class="hints-container" id="hints-container">
                    <!-- Hints g√©n√©r√©s dynamiquement -->
                </div>

                <!-- √âvolution -->
                <details class="evolution-details">
                    <summary>üìà √âvolution vs inflation</summary>
                    <div class="evolution-panel" id="evolution-section">
                        <div class="evolution-controls">
                            <label>
                                Projection :
                                <select id="projection-years" class="book-select-inline">
                                    <option value="5">5 ans</option>
                                    <option value="10" selected>10 ans</option>
                                    <option value="15">15 ans</option>
                                    <option value="20">20 ans</option>
                                    <option value="25">25 ans</option>
                                    <option value="30">30 ans</option>
                                    <option value="retraite">Retraite</option>
                                </select>
                            </label>
                            <label class="hidden" id="age-input-wrapper">
                                √Çge :
                                <input type="number" id="age-actuel" class="book-input-small" min="18" max="66" value="30">
                            </label>
                            <label>
                                Augmentation/an :
                                <input type="number" id="augmentation-annuelle" class="book-input-small" min="0" max="10" step="0.1" value="0">%
                            </label>
                        </div>
                        <div class="chart-container">
                            <canvas id="evolution-chart"></canvas>
                        </div>
                        <div class="evolution-summary">
                            <p id="evolution-summary"></p>
                            <small class="data-source" id="inflation-source">Inflation : chargement...</small>
                        </div>
                    </div>
                </details>

                <!-- Bouton pour v√©rifier les arri√©r√©s -->
                <div class="arretees-check-card" id="arretees-check-card">
                    <p class="arretees-check-text"><strong>üí° Vous pensez gagner moins que le minimum affich√© ?</strong></p>
                    <p class="arretees-check-text">Calculez vos arri√©r√©s de salaire et g√©n√©rez un rapport PDF pour les r√©clamer.</p>
                    <button class="book-btn btn-primary" id="btn-check-arretees">
                        Calculer mes arri√©r√©s
                    </button>
                </div>

                <div class="step-actions">
                    <button class="book-btn btn-secondary" id="btn-back-3">
                        <span class="btn-icon btn-icon-left">‚Äπ</span> Modifier
                    </button>
                    <button class="book-btn btn-primary" id="btn-restart">
                        <span class="btn-icon">‚Üª</span> Recommencer
                    </button>
                </div>
            </div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- √âTAPE 4 : ARRI√âR√âS DE SALAIRE -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="wizard-step hidden" id="step-4">
            <div class="step-content">
                <h2>Calcul des arri√©r√©s de salaire</h2>
                <p class="step-subtitle">Saisissez vos salaires r√©els mois par mois pour calculer pr√©cis√©ment vos arri√©r√©s</p>

                <div class="book-hint warning" id="arretees-warning">
                    <p><strong>‚ö†Ô∏è Important :</strong> Ce calcul est un outil d'aide. Pour toute action juridique, consultez un avocat sp√©cialis√© en droit du travail ou votre syndicat.</p>
                </div>

                <!-- Informations de base -->
                <div class="arretees-base-info">
                    <h3>Informations n√©cessaires</h3>
                    <div class="form-group">
                        <label for="date-embauche-arretees">
                            Date d'embauche
                            <span class="tooltip-trigger" data-tippy-content="Date de d√©but de votre contrat dans cette entreprise.">?</span>
                        </label>
                        <input type="date" id="date-embauche-arretees" class="book-input">
                    </div>

                    <details class="arretees-options-accordion result-details-toggle" id="arretees-options-accordion">
                        <summary class="arretees-options-accordion-title">Options et autres informations</summary>
                        <div class="arretees-options-accordion-body">
                            <div class="form-group">
                                <label for="date-changement-classification-arretees">
                                    Date de changement de classification
                                    <span class="tooltip-trigger" data-tippy-content="Si votre classification a chang√© au cours de votre contrat, indiquez la date. Sinon, laissez vide.">?</span>
                                </label>
                                <input type="date" id="date-changement-classification-arretees" class="book-input">
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="rupture-contrat-arretees" class="book-checkbox">
                                    <span>Le contrat est rompu</span>
                                </label>
                            </div>

                            <div class="form-group hidden" id="date-rupture-group-arretees">
                                <label for="date-rupture-arretees">Date de rupture du contrat</label>
                                <input type="date" id="date-rupture-arretees" class="book-input">
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="accord-ecrit-arretees" class="book-checkbox">
                                    <span>Un accord √©crit existe avec l'employeur concernant la classification</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="arretees-smh-seul" class="book-checkbox" checked>
                                    <span>Calculer les arri√©r√©s sur le SMH seul</span>
                                    <span
                                        class="tooltip-trigger"
                                        data-tippy-content="Si coch√© : salaire d√ª = assiette SMH (base + majorations forfaits).<br>
                                                            <strong>Inclus :</strong> <br>‚Ä¢ forfaits heures/jours, <br>‚Ä¢ 13e mois, <br>‚Ä¢ heures sup.<br>
                                                            <strong>Exclus :</strong> <br>‚Ä¢ primes anciennet√©/vacances, <br>‚Ä¢ majorations p√©nibilit√©, <br>‚Ä¢ nuit/dimanche/√©quipe.<br>
                                                            D√©cochez pour comparer √† la r√©mun√©ration compl√®te."
                                    >?</span>
                                </label>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- Interface de saisie avec graphique et bloc flottant (affich√©e uniquement quand la date d'embauche est renseign√©e) -->
                <div class="salary-curve-container hidden" id="salary-curve-container">
                    <h3>Saisie de vos salaires par mois</h3>
                    <p class="curve-help">Saisissez votre salaire mensuel brut pour chaque mois. Le graphique ci-dessous montre l'√©volution du salaire d√ª au fil du temps.</p>
                    <div class="book-hint warning arretees-salaire-hint" id="arretees-salaire-hint">
                        <p><strong>Attention :</strong> Lorsque ¬´ SMH seul ¬ª est coch√©, saisissez le <strong>salaire mensuel brut hors primes</strong> (sans prime vacances, prime anciennet√©, majorations p√©nibilit√©, nuit/dimanche/√©quipe). Le 13e mois et les majorations forfaits font partie du SMH. Sinon, indiquez le total brut du bulletin (y compris primes si vous comparez √† la r√©mun√©ration compl√®te).</p>
                    </div>
                    
                    <!-- Message quand pas de date (le canvas n'est jamais supprim√©) -->
                    <div class="timeline-no-date-message" id="timeline-no-date-message">
                        <p class="timeline-help">Veuillez renseigner la date d'embauche pour g√©n√©rer la courbe.</p>
                    </div>
                    
                    <!-- Canvas pour la courbe (toujours pr√©sent dans le DOM) -->
                    <div class="curve-chart-wrapper hidden" id="curve-chart-wrapper">
                        <canvas id="salary-curve-chart"></canvas>
                        <!-- Bloc flottant pour saisie -->
                        <div class="floating-input-block" id="floating-input-block">
                            <button type="button" class="floating-block-close" id="floating-block-close" aria-label="Fermer la saisie">√ó</button>
                            <div class="floating-label">
                                <span id="floating-period-label">...</span>
                                <span class="tooltip-trigger" id="floating-info-icon" data-tippy-content="Salaire mensuel brut : indiquez le ¬´ Total brut ¬ª de votre fiche de paie pour ce mois.">?</span>
                            </div>
                            <div class="input-with-unit floating-input">
                                <input type="number" id="floating-salary-input" class="book-input" min="0" step="100" placeholder="Salaire mensuel brut">
                                <span class="input-unit">‚Ç¨</span>
                            </div>
                            <p class="floating-hint">Appuyez sur <kbd>Entr√©e</kbd> pour valider</p>
                        </div>
                    </div>
                    
                    <!-- L√©gende -->
                    <div class="curve-legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background: #4caf50;"></span>
                            <span>Salaire r√©el saisi</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: #2196f3;"></span>
                            <span>Salaire d√ª</span>
                        </div>
                    </div>
                    
                    <!-- Progression (cliquable pour rouvrir la saisie si ferm√©e) -->
                    <div class="curve-progress" id="curve-progress" role="button" tabindex="-1" aria-label="Progression des mois saisis">
                        <span id="curve-progress-text">0 mois saisis</span>
                        <span class="curve-progress-reopen-hint" id="curve-progress-reopen-hint" aria-hidden="true"></span>
                    </div>
                </div>
                
                <!-- Bouton de calcul sticky (affich√© uniquement quand la date d'embauche est renseign√©e) -->
                <div class="arretees-calc-sticky hidden" id="arretees-calc-sticky">
                    <button class="book-btn btn-primary btn-large" id="btn-calculer-arretees-sticky">
                        Calculer les arri√©r√©s
                    </button>
                </div>

                <!-- R√©sultats (style align√© sur la section r√©sultat r√©mun√©ration) -->
                <div class="arretees-results hidden" id="arretees-results">
                    <div class="arretees-results-card">
                        <h3 class="arretees-results-title">R√©sultats du calcul</h3>
                        <div id="arretees-summary"></div>
                        <div id="arretees-legal-info"></div>
                        <button class="book-btn btn-primary" id="btn-generer-pdf-arretees">
                            G√©n√©rer le rapport PDF
                        </button>
                    </div>
                </div>

                <!-- Guide juridique (toujours visible apr√®s saisie, moderne et ludique) -->
                <div class="legal-guide-section hidden" id="legal-instructions">
                    <div class="legal-guide-header">
                        <h3 class="legal-guide-title">Guide juridique et prochaines √©tapes</h3>
                        <div class="legal-guide-nav">
                            <button class="carousel-btn carousel-btn-prev" id="legal-carousel-prev" aria-label="Pr√©c√©dent">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                            </button>
                            <span class="carousel-counter"><span id="legal-carousel-current">1</span> / <span id="legal-carousel-total">6</span></span>
                            <button class="carousel-btn carousel-btn-next" id="legal-carousel-next" aria-label="Suivant">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                            </button>
                        </div>
                    </div>
                    <div class="legal-guide-content" id="legal-carousel-content">
                        <!-- Contenu g√©n√©r√© dynamiquement -->
                    </div>
                </div>

                <div class="step-actions">
                    <button class="book-btn btn-secondary" id="btn-back-4">
                        <span class="btn-icon btn-icon-left">‚Äπ</span> Retour
                    </button>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="simulator-footer">
            <p>Convention Collective Nationale de la M√©tallurgie (CCNM) 2024 ‚Ä¢ <span class="disclaimer">Outil indicatif</span></p>
            <p class="footer-credit"><a href="https://cfdt-kuhn.fr" target="_blank" rel="noopener">R√©alis√© par CFDT Kuhn</a></p>
        </footer>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF pour g√©n√©ration PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Modules ES6 -->
    <script type="module" src="src/app-integration.js"></script>
    <script type="module" src="src/compat/expose-to-app.js"></script>
    <!-- Config et App -->
    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>
